<%= button_to "Sign Out", destroy_user_session_path, method: :delete %>

<% @users.each_with_index do |user, idx| %>
  <% if current_user.id == user.id %>
    <div class="profile-header">
      <div class="profile-header__avatar">
        <%= user.image_profile.attached? ? image_tag(user.image_profile) : image_tag('avatar-default.webp') %>
      </div>
      <div class="profile-header__info">
        <h2><%= user.name %></h2>
        <div class="stats">
          <div class="stats__item">
            <p>4</p>
            <p>Posts</p>
          </div>
          <div class="stats__item">
            <p><%= user.followers_count %></p>
            <p>Followers</p>
          </div>
          <div class="stats__item">
            <p><%= user.following_count %></p>
            <p>Following</p>
          </div>
        </div>
        <div class="actions">
          <%= render partial: 'follower/follower', locals: { user: user } if current_user != user %>
          <%= link_to 'Configure profile', edit_user_registration_path, class: 'btn' %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>

<%= render 'main/histories' %>

<div class="profile-sections" data-controller="profile">
  <div class="profile-sections__item">
    <i class="bi bi-house-fill post"></i>
  </div>
  <span></span>
  <div class="profile-sections__item">
    <i class="bi bi-camera-reels-fill video"></i>
  </div>
  <span></span>
  <div class="profile-sections__item">
    <i class="bi bi-image-fill image_post"></i>
  </div>
</div>

<div class="profile-main posts" data-controller="profile">
  <% @users.each_with_index do |user, idx| %>
    <%= render partial: 'cards', locals: {user: user} if current_user.id == user.id %>
  <% end %>
</div>

<div class="post-images images_post" data-controller="profile">
  <% @posts.each do |post| %>
    <% if post.images.attached? %>
      <% post.images.each do |image| %>
        <div>
          <%= image_tag image.representation(resize_to_limit: [300, 300]) %>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
